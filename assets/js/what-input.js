!function(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory():"function"==typeof define&&define.amd?define("whatInput",[],factory):"object"==typeof exports?exports.whatInput=factory():root.whatInput=factory()}(this,function(){return installedModules={},__webpack_require__.m=modules=[function(module,exports){"use strict";module.exports=function(){if("undefined"==typeof document||"undefined"==typeof window)return{ask:function(){return"initial"},element:function(){return null},ignoreKeys:function(){},specificKeys:function(){},registerOnChange:function(){},unRegisterOnChange:function(){}};var docElem=document.documentElement,currentElement=null,currentInput="initial",currentIntent=currentInput,currentTimestamp=Date.now(),shouldPersist="false",formInputs=["button","input","select","textarea"],functionList=[],ignoreMap=[16,17,18,91,93],specificMap=[],inputMap={keydown:"keyboard",keyup:"keyboard",mousedown:"mouse",mousemove:"mouse",MSPointerDown:"pointer",MSPointerMove:"pointer",pointerdown:"pointer",pointermove:"pointer",touchstart:"touch",touchend:"touch"},isScrolling=!1,mousePos={x:null,y:null},pointerMap={2:"touch",3:"touch",4:"mouse"},supportsPassive=!1;try{var opts=Object.defineProperty({},"passive",{get:function(){supportsPassive=!0}});window.addEventListener("test",null,opts)}catch(e){}var addListeners=function(){var options=!!supportsPassive&&{passive:!0};document.addEventListener("DOMContentLoaded",setPersist),window.PointerEvent?(window.addEventListener("pointerdown",setInput),window.addEventListener("pointermove",setIntent)):window.MSPointerEvent?(window.addEventListener("MSPointerDown",setInput),window.addEventListener("MSPointerMove",setIntent)):(window.addEventListener("mousedown",setInput),window.addEventListener("mousemove",setIntent),"ontouchstart"in window&&(window.addEventListener("touchstart",setInput,options),window.addEventListener("touchend",setInput))),window.addEventListener(detectWheel(),setIntent,options),window.addEventListener("keydown",setInput),window.addEventListener("keyup",setInput),window.addEventListener("focusin",setElement),window.addEventListener("focusout",clearElement)},setPersist=function(){if(shouldPersist=!(docElem.getAttribute("data-whatpersist")||"false"===document.body.getAttribute("data-whatpersist")))try{window.sessionStorage.getItem("what-input")&&(currentInput=window.sessionStorage.getItem("what-input")),window.sessionStorage.getItem("what-intent")&&(currentIntent=window.sessionStorage.getItem("what-intent"))}catch(e){}doUpdate("input"),doUpdate("intent")},setInput=function(event){var eventKey=event.which,value=inputMap[event.type];"pointer"===value&&(value=pointerType(event));var activeElem,ignoreMatch=!specificMap.length&&-1===ignoreMap.indexOf(eventKey),specificMatch=specificMap.length&&-1!==specificMap.indexOf(eventKey),shouldUpdate="keyboard"===value&&eventKey&&(ignoreMatch||specificMatch)||"mouse"===value||"touch"===value;validateTouch(value)&&(shouldUpdate=!1),shouldUpdate&&currentInput!==value&&(persistInput("input",currentInput=value),doUpdate("input")),!shouldUpdate||currentIntent===value||(activeElem=document.activeElement)&&activeElem.nodeName&&(-1===formInputs.indexOf(activeElem.nodeName.toLowerCase())||"button"===activeElem.nodeName.toLowerCase()&&!checkClosest(activeElem,"form"))&&(persistInput("intent",currentIntent=value),doUpdate("intent"))},doUpdate=function(which){docElem.setAttribute("data-what"+which,"input"===which?currentInput:currentIntent),fireFunctions(which)},setIntent=function(event){var value=inputMap[event.type];"pointer"===value&&(value=pointerType(event)),detectScrolling(event),(!isScrolling&&!validateTouch(value)||isScrolling&&"wheel"===event.type||"mousewheel"===event.type||"DOMMouseScroll"===event.type)&&currentIntent!==value&&(persistInput("intent",currentIntent=value),doUpdate("intent"))},setElement=function(event){event.target.nodeName?(currentElement=event.target.nodeName.toLowerCase(),docElem.setAttribute("data-whatelement",currentElement),event.target.classList&&event.target.classList.length&&docElem.setAttribute("data-whatclasses",event.target.classList.toString().replace(" ",","))):clearElement()},clearElement=function(){currentElement=null,docElem.removeAttribute("data-whatelement"),docElem.removeAttribute("data-whatclasses")},persistInput=function(which,value){if(shouldPersist)try{window.sessionStorage.setItem("what-"+which,value)}catch(e){}},pointerType=function(event){return"number"==typeof event.pointerType?pointerMap[event.pointerType]:"pen"===event.pointerType?"touch":event.pointerType},validateTouch=function(value){var timestamp=Date.now(),touchIsValid="mouse"===value&&"touch"===currentInput&&timestamp-currentTimestamp<200;return currentTimestamp=timestamp,touchIsValid},detectWheel=function(){return"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"},fireFunctions=function(type){for(var i=0,len=functionList.length;i<len;i++)functionList[i].type===type&&functionList[i].fn.call(void 0,"input"===type?currentInput:currentIntent)},detectScrolling=function(event){mousePos.x!==event.screenX||mousePos.y!==event.screenY?(isScrolling=!1,mousePos.x=event.screenX,mousePos.y=event.screenY):isScrolling=!0},checkClosest=function(elem,tag){var ElementPrototype=window.Element.prototype;if(ElementPrototype.matches||(ElementPrototype.matches=ElementPrototype.msMatchesSelector||ElementPrototype.webkitMatchesSelector),ElementPrototype.closest)return elem.closest(tag);do{if(elem.matches(tag))return elem;elem=elem.parentElement||elem.parentNode}while(null!==elem&&1===elem.nodeType);return null};return"addEventListener"in window&&Array.prototype.indexOf&&(inputMap[detectWheel()]="mouse",addListeners()),{ask:function(opt){return"intent"===opt?currentIntent:currentInput},element:function(){return currentElement},ignoreKeys:function(arr){ignoreMap=arr},specificKeys:function(arr){specificMap=arr},registerOnChange:function(fn,eventType){functionList.push({fn:fn,type:eventType||"input"})},unRegisterOnChange:function(fn){var position=function(match){for(var i=0,len=functionList.length;i<len;i++)if(functionList[i].fn===match)return i}(fn);!position&&0!==position||functionList.splice(position,1)},clearStorage:function(){window.sessionStorage.clear()}}}()}],__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0);function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var modules,installedModules});